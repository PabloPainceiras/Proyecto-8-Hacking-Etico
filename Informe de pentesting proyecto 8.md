# Informe de pentesting proyecto 8

**Índice**

Sobre este documento

- **Declaración de Confidencialidad**
- **Descargo de responsabilidad**

Resumen ejecutivo

- **Antecedentes y alcance**
- **Advertencias**
- **Calificaciones de Severidad de Hallazgos**
- **Tabla de Calificaciones**

Hallazgos Técnicos

**Conclusión**

Metodología

Sobre este documento


| Acerca del documento |    |
|---------------|--------------|
| Clasificación | Confidencial |
| Cliente	| Talent ScoutTech |
| Referencia | ID-001 |
| Documento	| Auditoria de aplicación web |
| Autor	| Pablo Painceiras Martinez |
| Versión | 1.0 |
| Fecha	| 04/06/2024 |
| Estado | Finalizado |

| Personal |    |
|---------------|--------------|
| Nombre	| Función | Empresa | Contacto |
| Pablo Painceiras Martinez |	Auditor |	ANPIPADA SL. | Email: ppaimar3001@g.educaand.es |
| Jorge Javier Sanchez Perez | Responsable IT |	Talent ScoutTech | Email: JJsanpe@talenscout.es |
| David Portillo Fernandez |	Mánager ejecutivo	| Talent ScoutTech | Email: Dporfer@talentscout.es |



**Declaración de Confidencialidad**

Este documento es propiedad exclusiva de ANPIPADA S.L. e Talent ScoutTech. Contiene información confidencial y propietaria. La duplicación, redistribución o uso, total o parcial, en cualquier forma, requiere el consentimiento de ANPIPADA e Talent ScoutTech. Talent ScoutTech puede compartir este documento con auditores bajo acuerdos de confidencialidad para demostrar el cumplimiento de los requisitos de prueba de penetración.

**Descargo de responsabilidad**

Una prueba de penetración se considera una instantánea en el tiempo. Los hallazgos y recomendaciones reflejan la información recopilada durante la evaluación y no cualquier cambio o modificación realizada fuera de ese período. Las contrataciones con límite de tiempo no permiten una evaluación completa de todos los controles de seguridad. ANPIPADA priorizó la evaluación para identificar los controles de seguridad más débiles que un atacante podría explotar. ANPIPADA recomienda llevar a cabo evaluaciones similares de forma anual por evaluadores internos o de terceros para asegurar el éxito continuo de los controles.

**Resumen ejecutivo**

**Antecedentes y alcance**

En este proyecto, Talent ScoutTech ha contratado a ANPIAPDA SL para llevar a cabo una auditoría de seguridad en una aplicación web, con el objetivo de identificar posibles vulnerabilidades en su código. La evaluación se realizó del 20 al 31 de junio de 2024.

Para esta auditoría, se facilitó el código fuente de la aplicación, permitiendo que se realizara bajo la modalidad de "Caja Blanca". El auditor se encargó de desplegar la aplicación en un servidor propio, ejecutándola en un entorno local.

**Advertencias**

Las pruebas se llevaron a cabo en un entorno controlado por el auditor, por lo que los resultados podrían variar al trasladarse a un entorno de producción.

**Calificaciones de Severidad de Hallazgos**

La siguiente tabla define niveles de gravedad y el rango correspondiente de puntuación CVSS que se utilizan en todo el documento para evaluar la vulnerabilidad y el impacto del riesgo.

| Severidad | Puntuación CVSS | Definición |
| --- | --- | --- |
| Critica | 9.0 - 10.0 | La explotación es directa y generalmente resulta en la comprometimiento a nivel del sistema. Se recomienda formular un plan de acción y aplicar el parche de inmediato. |
| Alta | 7.0 - 8.9 | La explotación es más difícil pero podría resultar en privilegios elevados y potencialmente en pérdida de datos o tiempo de inactividad. Se recomienda formular un plan de acción y aplicar el parche tan pronto como sea posible. |
| Media | 4.0 - 6.9 | Existen vulnerabilidades pero no son explotables o requieren pasos adicionales como ingeniería social. Se recomienda formular un plan de acción y aplicar el parche después de que se hayan resuelto los problemas de alta prioridad. |
| Baja | 0.1 - 3.9 | Las vulnerabilidades no son explotables pero reducirían la superficie de ataque de una organización. Se recomienda formular un plan de acción y aplicar el parche durante la próxima ventana de mantenimiento. |
| Informativa | N/A | No existe ninguna vulnerabilidad. Se proporciona información adicional sobre los elementos observados durante las pruebas, controles sólidos y documentación adicional disponible. |

**Tabla de Calificaciones**

Las siguientes tablas ilustran las vulnerabilidades encontradas por impacto y las recomendaciones de remedio:


| Critica | Alta | Media | Baja | Informativa |
|---------|------|-------|------|-------------|
|  2  | 1 | 1 | 0 | 0 |


Hallazgos Técnicos

Hallazgo AW-001 :


| Nombre | Inyección SQL |
|-------------|-------------|
| Description | La inyección SQL en un formulario de inicio de sesión permite a un atacante autenticarse como cualquier otro usuario o manipular la base de datos mediante consultas maliciosas. |
| CVE/CWE | [CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')](https://cwe.mitre.org/data/definitions/89.html) |
| CVSS v3 | 9.8 |
| Impacto | Crítico |
| URL Afectada | http://localhost/private/auth.php |
| Remediación | Una buena práctica para prevenir inyecciones SQL es sanitizar la entrada del usuario mediante funciones como bindValue o prepare(). Estas técnicas ayudan a evitar que caracteres maliciosos comprometan la seguridad de la aplicación. |
| POC | [](img/2.png) |
| Referencias | https://owasp.org/www-community/attacks/SQL_Injection |



Hallazgo AW-002 :


| Nombre | Cross Site Scripting |
|-------------|-------------|
| Description | El formulario de comentarios no realiza una validación adecuada de la entrada, lo que permite a un atacante ejecutar código. Además, este código se almacena en la base de datos y se ejecutaría en cualquier navegador que abra la URL objetivo |
| CVE/CWE | [CWE-79: Improper Neutralization of Input During Web Page Generation](https://cwe.mitre.org/data/definitions/79.html) |
| CVSS v3 | 9.8 |
| Impacto | Crítico |
| URL Afectado | http://localhost/add_comment.php?id=5 |
| Remediación | Para solucionar este problema y mejorar la seguridad del sitio, es necesario implementar una sanitización adecuada en los parámetros GET antes de insertarlos en el HTML. Una forma común de hacer esto es utilizando la función **`htmlspecialchars()`** en PHP para escapar los caracteres especiales en HTML. |
| POC | [](img/3.png), [](img/4.png) |
| Referencias | https://owasp.org/www-community/attacks/xss/ |


Hallazgo AW-003 :


| Nombre | Cross Site Scripting HTML |
|-------------|-------------|
| Description | Un atacante puede insertar código HTML a través del formulario de creación de equipos, lo que le permitiría alterar la apariencia de la página. Por ejemplo, podría agregar botones que redirijan a enlaces maliciosos. |
| CVE/CWE | [CWE-79: Improper Neutralization of Input During Web Page Generation](https://cwe.mitre.org/data/definitions/79.html) |
| CVSS v3 | 8.2 |
| Impacto | Alta |
| URL Afectado | http://localhost/list_players.php |
| Remediación |  Asegúrate de que el formulario valide exhaustivamente los datos ingresados por el usuario y evite etiquetas HTML o scripts maliciosos. Al procesar la entrada del usuario, escapa los caracteres especiales para evitar que se interpreten como código HTML. |
| POC | [](img/6.png) |
| Referencias | https://owasp.org/www-community/attacks/xss/ |

Hallazgo AW-004 :


| Nombre | Debug activado, proporcionando información(Information Disclosure) |
|-------------|-------------|
| Description | Esta inyeccion le permite a un tacante obtener información sobre el funcionamiento interno de la aplicación. |
| CVE/CWE | [CWE-200: Exposure of Sensitive Information to an Unauthorized Actor](https://cwe.mitre.org/data/definitions/200.html) |
| CVSS v3 | 5.3 |
| Impacto | Media |
| URL Afectado | http://localhost/private/auth.php|
| Remediación | Deshabilitar la opción de debuging de la aplicación  |
| POC | [](img/1.png) |
| Referencias | https://www.zaproxy.org/docs/alerts/10023/ |


**Conclusión**

Se ha determinado que la aplicación auditada presenta deficiencias en su seguridad y requiere correcciones urgentes. Es evidente que no se recomienda implementar esta aplicación en producción sin aplicar los parches especificados.

Los problemas principales se originan por el inadecuado saneamiento y manejo de las entradas de los usuarios, lo que permite a un atacante escribir información en la base de datos y alterar completamente el contenido de la aplicación web.

**Metodologías**

La metodología usada ha sido la OWASP Web Security Testing Guide v4.2

Referencia: [https://owasp.org/www-project-web-security-testing-guide/](https://owasp.org/www-project-web-security-testing-guide/)
